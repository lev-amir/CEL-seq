---
title: "Tbox transcription factors gene regulation heatmap"
author: "Amir Levine"
date: "2018-10-25"
output: md_document
---
<!-- Load packages and datasets. -->
<!-- ```{r} -->
<!-- if (!require(tidyverse)) {install.packages("tidyverse"); library(tidyverse)} -->
<!-- #if (!require(dendextend)) {install.packages("dendextend"); library("dendextend")} -->
<!-- #if (!require(ComplexHeatmap)) {biocLite("ComplexHeatmap"); library("ComplexHeatmap")} -->
<!-- if (!require(gplots)) {biocLite("gplots"); library("gplots")} -->
<!-- if (!require(viridis)) {biocLite("viridis"); library("viridis")} -->

<!-- load("data/geneExpression.rdata") -->
<!-- load("experiments/2018-07-11-tbx-motifs/data/Tbox-anc1-reg-enriched.Rdata") -->
<!-- ``` -->

<!-- # Data Pre-Processing -->
<!-- ```{r} -->
<!-- # Separate AM140 and N2 data. -->
<!-- # Separate data that may be relevant for clustering. -->
<!-- AM <- BOTH %>% select(Gene_stable_ID,Gene_name,strain,baseMean,log2FoldChange, -->
<!--                 lfcSE, stat,pvalue,padj) %>% filter(strain == "AM140") -->
<!-- NT <- BOTH %>% select(Gene_stable_ID,Gene_name,strain,baseMean,log2FoldChange, -->
<!--                 lfcSE, stat,pvalue,padj) %>% filter(strain == "N2") -->
<!-- AM.NT <- full_join(NT,AM,by = c('Gene_stable_ID','Gene_name'), suffix = c(".N2",".AM140")) -->

<!-- # Create p-values matrix -->
<!-- # Obtain the *p*-values of motifs per sequence. -->
<!-- # * Rows correspond to the different input sequences and the columns correspond to motifs. -->
<!-- # * `sequence.nobg` contains the raw affinity scores. -->
<!-- # * `sequence.bg` contains the corresponding P-values. -->

<!-- pvals.dn.mat <- res.dn$sequence.bg -->

<!-- # Rename the column names to be the T-box protein names. -->
<!-- colnames(pvals.dn.mat) <- c("TBX33","TBX38","TBX39","TBX40","TBX43") -->

<!-- # Covert the *p*-values matrix to a tibble to merge with the previous data-object. -->
<!-- pvals.dn <- as.tibble(pvals.dn.mat) -->
<!-- pvals.dn <- mutate(pvals.dn, Gene_stable_ID = rownames((pvals.dn.mat))) -->

<!-- # Combine the TBX binding-sties p-values with the previous data-object. -->
<!-- DEG.TBX <- inner_join(AM.NT, pvals.dn, by='Gene_stable_ID') -->
<!-- ``` -->

<!-- # Convert the dataframes to matrices of TBX p-values -->
<!-- ```{r} -->
<!-- # TBX binding motifs Matrix -->
<!-- DEG.TBX.MAT <- DEG.TBX %>%  -->
<!--   select("TBX33","TBX38","TBX39","TBX40","TBX43") %>% -->
<!--   as.matrix() -->
<!-- rownames(DEG.TBX.MAT) <- DEG.TBX$Gene_name -->
<!-- # Scaling???!?? -->
<!-- ``` -->

<!-- # Convert the TBX p-values matrix to binary -->
<!-- ```{r} -->
<!-- # Change *p*-value to boolean. TRUE is statistically significant (*p*-value < 0.05). -->
<!-- DEG.TBX.MAT.BOOL <- (DEG.TBX.MAT < 0.1) -->

<!-- # Index of amount of T-box transcription factors binding motif -->
<!-- TBXTFBM <- rowSums(DEG.TBX.MAT.BOOL*1)  -->

<!-- # Filter genes w/o T-box transcription factors binding motifs from the Boolean matrix -->
<!-- DEG.TBX.MAT.BOOL <- DEG.TBX.MAT.BOOL[TBXTFBM != 0,] -->

<!-- # Filter genes w/o T-box transcription factors binding motifs from the p-values matrix -->
<!-- DEG.TBX.MAT <- DEG.TBX.MAT[TBXTFBM != 0,] -->
<!-- ``` -->


----

# Convert the dataframe to matrices of Log2Fold-Change
```{r}
DEG.MAT <- DEG.TBX %>% select(log2FoldChange.N2,log2FoldChange.AM140) %>%
  as.matrix()
rownames(DEG.MAT) <- DEG.TBX$Gene_name
```

